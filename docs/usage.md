# 项目操作手册

本文档记录 QuantPyLab 的所有运行指令及其参数说明。

### 1. 数据采集 (Data Ingestion)

#### 股票列表同步 (Basic Sync)
同步 A 股全量股票的基础代码与名称。
- **命令**: `uv run main.py --sync-stocks`
- **逻辑**: 
    1. 采用 **DELETE + append** 模式。
    2. 仅同步当前在市（Active）的股票。
- **建议频率**: 每周执行一次。
- **原因**: 保持数据库干净，仅包含当前可交易标的。
- **注意**: 历史退市股票目前不在同步范围内，`is_active` 字段对当前同步的股票默认均为 1。

#### 股票元数据补全 (Enrichment)
补全行业、地域、上市日期。
- **命令**: `uv run main.py --enrich-metadata [--limit N]`
- **策略**: 
    1. **Stage 1 (高速)**: 利用东财原生接口批量刷新行业信息。
    2. **Stage 2 (增量)**: 利用雪球和东财个股接口补全地域与上市日期。
- **建议频率**: 每次执行完 `--sync-stocks` 后执行，或每季度执行一次。
- **原因**: 行业分类和地域信息相对稳定，无需频繁更新。
- **性能**: 行业同步仅需约 1-2 分钟；详细信息补全视待处理数量而定（约 2-3 次请求/秒）。

### 财务报表同步
同步 A 股全量历史财务报表（资产负债表、利润表、现金流量表）。
- **命令**: `uv run main.py --sync-fin [--limit N]`
- **逻辑**: 
    1. 从新浪财经抓取全量历史报表。
    2. 存储至 DuckDB 宽表，支持动态列扩展以兼容不同行业的科目差异。
    3. 采用单线程同步以保证数据库 Schema 演进的安全性。
- **建议频率**: 每季度（财报季后）执行一次，或按需同步。
- **注意**: 首次全量同步耗时较长（约 2-3 小时）。

## 2. 环境维护
- **刷新 AI 上下文**: 在 Gemini CLI 中执行 `/memory refresh` 以加载最新的 `.gemini/GEMINI.md` 指令。
- **清理缓存**: (待添加)
